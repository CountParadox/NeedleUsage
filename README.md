This code is based on CountParadox's NeedleUsage repo. I just modified it slightly to be more easily extensible.